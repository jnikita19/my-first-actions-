name: Docker Build

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  notify-start:
    runs-on: ubuntu-latest
    steps:
      - name: Notify Slack - Build Starting
        uses: act10ns/slack@v1
        with:
          status: starting
          channel: "#github-actions-notification"
          message: "ðŸš€ Starting Docker build for `ghcr.io/my-org/my-app:latest`"
          webhook-url: ${{ secrets.SLACK_WEBHOOK_URL }}
          
  docker:
    uses: AmanjotSinghSaini-int/ci-templates/.github/workflows/docker-build.yml@main
    with:
      image_name: ghcr.io/my-org/my-app:latest
      dockerfile_path: ./Dockerfile
      context: .
      build_args: "--no-cache"
      run_trivy: false
      continue_on_trivy_error: false
      run_gitleaks: false
      continue_on_gitleaks_error: true
      run_owasp: false
      continue_on_owasp_error: false
